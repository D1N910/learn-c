# 特殊矩阵的压缩存储

## 简介
- 数组的存储结构
  - 一维数组
  - 二维数组
- 特殊矩阵
  - 对称矩阵
  - 三角矩阵
  - 三对角矩阵
  - 稀疏矩阵

## 一维数组的存储结构
- 各数组的大小相同，且物理上连续存放
- 数组元素a[i]的存放地址 = LOC + i*sizeof(ElementType) (0<=i<=10) 注：除非题目特别说明，否则数组下标默认从 0 开始（注意审题！易错！）

## 二维数组的存储结构
ElementType b[2][4]; // 2行4列的二维数组

b[0][0]b[0][1]b[0][2]b[0][3]

...

- 行优先存储

b[0][0]b[0][1]b[0][2]b[0][3]

存储地址计算:起始地址LOC,M行N列的二维数组[M][N]中，若按行优先存储，则b[i][j]（初始下标为0,0）的存储地址 = LOC + (i*N + j)*sizeof(ElementType)


- 列优先存储

b[0][0]b[1][0]b[0][1]b[1][1]

存储地址计算:起始地址LOC,M行N列的二维数组[M][N]中，若按行优先存储，则b[i][j]（初始下标为0,0）的存储地址 = LOC + (j*M + i)*sizeof(ElementType)

## 普通矩阵的存储
描述矩阵元素时，行、列好通常从 1 开始：而描述数组时通常下标从 0 开始。（具体看题目给的条件，注意审题！）

可用二维数组存储

某些特殊矩阵可以压缩存储空间。

特殊矩阵：

- 对称矩阵

- 三角矩阵

- 三对角矩阵

- 稀疏矩阵

对称矩阵、三角矩阵、三对角矩阵是方阵，n行n列


## 对称矩阵的压缩存储

### 定义

若 n 阶方阵中任意一个元素 $a_{i,j}$ 都有 $a_{i,j}=a_{j,i}$ 则该矩阵为对称矩阵。

主对角线：$i=j$

上三角区：$i<j$

下三角区: $i>j$

### 压缩存储策略：

#### 只存储主对角线+下三角区域 - 按行优先原则

将各元素存入一维数组中

##### 思考
- 数组大小：$1 + 2 + ... + n = \frac{n(1+n)}{2}$
- 站在程序员的角度，对称举证压缩存储后怎么样才能方便实用。
可以实现一个`映射`函数，矩阵下标->一维数组下标

$a_{i,j} (i>=j)$ -> $B[k]$

key：按行优先原则，$a_{i,j}$是第几个元素？第$\frac{(i-1)i}{2}+j$个元素，数组下标第$\frac{(i-1)i}{2}+j-1$（有的题目下标是从1开始的，就不用-1）

$a_{i,j}(i<j)$ -> $a_{j,i}(i<j)$ -> $B[k]$

#### 只存储主对角线+下三角区域 - 按列优先原则

$a_{i,j} (i>=j)$ -> $B[k]$

总元素数量: $\frac{n(n-1)}{2}$

key：按列优先原则，$a_{i,j}$是第几个元素？$\frac{(j-1)(2n - j + 2))}{2} + (i - j) + 1$，数组下标是$\frac{(j-1)(2n - j + 2))}{2} +  (i - j) + 1 - 1$

### 出题方法
- 存储上三角？下三角？
- 行优先？列优先？
- 矩阵元素的下标从0？1？开始
- 数组下标从0？1？开始


## 三角矩阵的压缩存储
- 上三角矩阵，除了主对角线和上三角区域，其余元素都【相同】
- 下三角矩阵，除了主对角线和下三角区域，其他元素都【相同】

压缩存储策略:按行/列优先原则，将不同的区域存入一维数组中，并在`最后一个位置存储常量C` 

- 数组大小：$1 + 2 + \dots + n + 1 = \frac{n(1+n)}{2} + 1$

key：按行优先原则，$a_{i,j}$是第几个元素？

$$
k=\begin{cases}
 & \frac{i(i-1)}{2}+j-1 \text{ ,if } i \geqslant j \\ 
 & \frac{n(n+1)}{2} \text{ ,if } i<j 
\end{cases}
$$

## 三对角矩阵的压缩存储，又称带状矩阵

当 $\left |i-j \right | > 1$ 时，有 $a_{i}{j} = 0 (1\leqslant i, j\leqslant n)$)

- 主对角线 i = j, i - j = 0;
- 主对角线上下左右相邻的都是非零的
- 其他都是零的

按行一行一行存储带状部分。

长度：n >= 2,3n - 2;n=1, 1.

从零开始的话,B[0]，最后一个是 B[3n-3]

三对角矩阵的行号和列号转换为一维数组下标。

如果相差绝对值大于1，都是0；

如果i和j的差值小于1才讨论。

前 i - 1 行是 (i-1)*3-1 = 3i - 4 个元素

ai,j是i行第j-i+2个元素

那么ai.j 就是第 2i + j - 2 个元素；

如果下标从0开始的数组，那么就是第 2i + j - 3 个元素。

若已知数组下标 k，如何得到 i,j？

B[k] ->

第 k+1 个元素，在第几行？第几列？

3(i-1) - 1 < k+1 <= 3i - 1

i = [(k+2)/3]，向上取整

王道书是向下取整
-> ai,j

## 稀疏矩阵的压缩存储

- 顺序存储：三元组<行，列，值>，行、列的内容从1开始

- 十字链表法
