# 表达式求值问题
## 知识总览
### 三种算数表达式
- 中缀表达式
- 后缀表达式（考得更多，应为应用面更广）
- 前缀表达式
### 后缀表达式相关考点（考得更多，应为应用面更广）
- 中缀表达式转后缀表达式
- 后缀表达式求值
### 前缀表达式
- 中缀表达式转前缀表达式
- 前缀表达式求值

## 引言
### 大家熟悉的算术表达式-中缀表达式

Reference: Wikipedia -- Reverse Polish notation

((15/(7-(1+1)))*3)-(2+(1+1))

由三个部分组成：操作数、运算符、界限符（是非常重要的，没有界限符就不能很好地表示计算的顺序）

先计算前面的括号里面的>最里面的括号的
### 不用界限符也能无歧义地表示运算先后顺序（波兰数学家的想法）

Polish notaion(波兰表达式=前缀表达式)

Reverse Polish notaion（逆波兰表达式=后缀表达式）

## 三种算数表达式详细介绍(左右顺序不能搞错)
- 中缀表达式：运算符在两个操作数中间
- 后缀表达式：运算符在两个操作数后面
- 前缀表达式：运算符在两个操作数前面

中: a + b;后: a b +；前: + a b；

中: a+b-c;后: ab+c-(abc-+);前: -+abc;

中: a+b-c*d;后: ab+cd*-;前: -+ab*cd;

## 中缀表达式转后缀表达式（手算）

中缀转后缀手算

（1）确定中缀表达式中各个运算符的运算顺序；

（2）选择下一个运算符，按照【左操作数 右操作数 运算符】的方式组合成一个新的操作数

（3）如果还有运算符没被处理。继续执行（2）

中缀：((15/(7-(1+1)))*3)-(2+(1+1))

后缀：15 7 1 1 + - / 3 x 2 1 1 + + -

后缀表达式的符号序号和中缀表达式的符号序号一致——这样比较好

A + B * (C - D) - E / F

3 2 1 5 4

ABCD-*+EF/-

1 2 3 4 5

A + B * (C - D) - E / F

53241

可能是：

ABCD-*EF/-+

2 3 1 4 5

但是”机算“最好是按照前者的，顺序来的。—— 数字也按照顺序排

私房菜：“左优先”原则（运算符等级相同的话，能够先算左边的就算左边的），不要FreeStyle，保证计手算和计算结果相同

A + B - C * D / E + F

1 4 2 3 5

A B + C D * E / -F +

1 2 3 4 5

后缀表达式的手算方式：

从左往右扫描，每遇到一个运算符，就让运算符前面最近的两个操作数执行对应运算

合体为一个操作数

注意：两个操作数的左右顺序

## 后缀表达式（机算）
用栈实现后缀表达式的计算：
（1）从左往右扫描下一个元素，直到处理完所有元素；

（2）若扫描到操作数则压入栈，并回到（1）；否则执行（3）；

（3）若扫描到运算符，则弹出两个栈顶元素，执行相应运算，运算结果压回栈顶，回到（1）。

先出栈的是右操作数

### 计算机实现步骤
初始化一个栈，用于保存【暂时还不能确定运算顺序的运算符】。

从左到右处理各个元素，直到末尾，可能遇到三种情况：

- ①遇到操作数。直接加入后缀表达式。

- ②遇到界限符。遇到"("直接入栈，遇到")"则一次弹出栈内运算符并加入到后缀表达式，直到弹出"("位置。注意："("不加入后缀表达式.

- ③遇到运算符。依次弹出占中优先级高于或者等于当前运算符的所有运算符，并加入后缀表达式。若碰到")"或栈空则停止。之后再把当前运算符入栈。

按上述方法处理完所有字符后，将栈中剩余运算符依次弹出，并加入后缀表达式。


## 后缀表达式怎么转中缀表达式
逆序完成
A B + C D * E / -F +
B+A-C*D/E+F

## 中缀表达式转前缀表达式（手算）
中缀转前缀手算
（1）确定中缀表达式中各个运算符的运算顺序；

（2）选择下一个运算符，按照【运算符 左操作数 右操作数 】的方式组合成一个新的操作数

（3）如果还有运算符没被处理。继续执行（2）

“右优先”原则，运算符等级相同的话，能够先算右边的就算右边的

中缀：A + B * (C - D) - E / F

3214765

前缀：-+A*B-CD/EF 这种可以但是不够爽

+A-*B-CD/EF 这个好

中缀：((15/(7-(1+1)))*3)-(2+(1+1))

5 4 3 6 7 2 1

前缀表达式（机算）

- * / 15 - 7 + 1 1 3 + 2 + 1 1

（1）从【右往左】扫描下一个元素，直到处理完所有元素；

（2）若扫描到操作数则压入栈，并回到（1）；否则执行（3）； 

（3）若扫描到运算符，则弹出两个栈顶元素，执行相应运算，运算结果压回栈顶，回到（1）。 

先出栈的是左操作数

左右操作数、左右优先是作者自己杜撰的（干！）

## 考点
- 后缀表达式：栈是数组，容量不够，可能存在栈移除的情况

- 考察栈内运算符的顺序

## 计算机实现中缀表达式的计算 - 很重要考虑代码编译，CPU只能一条一条执行

初始化两个栈分别存操作数和运算符；

若扫描到操作数，压入操作数栈；

若扫描到运算符或界限符，则按照“中缀转后缀”相同的逻辑压入运算符栈（期间也会弹出运算符，`每弹出一个运算符时，就需要再弹出两个操作数栈的栈顶元素并执行相应运算，运算结果再押回操作数栈`）

todo 实现程序 3.3_3 栈在表达式求值中的应用 16:32
